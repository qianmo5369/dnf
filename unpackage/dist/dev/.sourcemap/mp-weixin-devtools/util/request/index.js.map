{"version":3,"names":["http","js_sdk_luchRequest_luchRequest_core_Request","Request","baseURL","util_env","baseUrl","timeout","custom","auth","interceptors","request","use","config","userStore","stores_user","useUserStore","token","header","common_vendor","index","showLoading","title","error","Promise","reject","response","hideLoading","data","code","showToast","msg","icon","__f__","statusCode","logout","reLaunch","url","plugin","install","app","globalProperties","$http"],"sources":["index.js"],"sourcesContent":["import {\r\n\tbaseUrl\r\n} from \"../env\";\nimport Request from '@/js_sdk/luch-request/luch-request/index.js' // ‰∏ãËΩΩÁöÑÊèí‰ª∂\nimport { useUserStore } from '@/stores/user'\r\n// ÂàõÂª∫ÂÆû‰æã\nconst http = new Request({\n  baseURL: baseUrl, // ‰øÆÊîπ‰∏∫‰Ω†ÁöÑÂú∞ÂùÄ\n  timeout: 10000,\n  custom: {\n    auth: true // Ëá™ÂÆö‰πâÂ≠óÊÆµÁ§∫‰æã\n  }\n})\n\n// ËØ∑Ê±ÇÊã¶Êà™Âô®\nhttp.interceptors.request.use((config) => {\n\tconst userStore = useUserStore()\n\tif (userStore.token) {\n\t    config.header.token = userStore.token\n\t  }\n  // const token = uni.getStorageSync('token')\n  // if (token && config.custom?.auth) {\n  //   config.header.token = token\n  // }\n  uni.showLoading({\n  \ttitle: 'Âä†ËΩΩ‰∏≠...'\n  })\n  return config\n}, (error) => {\n  return Promise.reject(error)\n})\n\n// ÂìçÂ∫îÊã¶Êà™Âô®\nhttp.interceptors.response.use((response) => {\n  // ‰∏öÂä°ÊàêÂäüÁ†Å\n  uni.hideLoading()\n  if (response.data.code === 1 || response.data.code === 200) {\n    return response.data;\n  } else {\n    uni.showToast({\n      title: response.data.msg || 'ËØ∑Ê±ÇÈîôËØØ',\n      icon: 'none'\n    })\n    return Promise.reject(response.data)\n  }\n}, (error) => {\n  console.log(error.statusCode);\n  \n  if (error.statusCode == 401) {\n  \t  uni.showToast({\n  \t    title: 'ËØ∑ÂÖàÁôªÂΩï',\n  \t    icon: 'none'\n  \t  })\n\t  \n\t  const userStore = useUserStore()\n\t      userStore.logout()\n\t  \n  \t uni.reLaunch({ url: '/pages/login/login' })\n  }else{\n\t  uni.showToast({\n\t    title: 'ÁΩëÁªúÂºÇÂ∏∏',\n\t    icon: 'none'\n\t  })\n  }\n \n  \n  // uni.hideLoading()\n  return Promise.reject(error)\n})\n\n\nconst plugin = {\n  install(app) {\n    app.config.globalProperties.$http = http\n    uni.$http = http // ËÆ© setup ‰∏≠‰πüËÉΩ‰ΩøÁî®\n  }\n}\n\n// üëâ ÈáçÁÇπÔºöÂêåÊó∂ÂØºÂá∫Êèí‰ª∂Âíå http ÂÆû‰æã\nexport {\n  http\n}\nexport default plugin\n\n// const test = {}\n// export default test\n\n// export default {\n//   install(app) {\n//     app.config.globalProperties.$http = http\n//   }\n// }"],"mappings":";;;;;;;AAMA,IAAMA,IAAA,GAAO,IAAIC,2CAAA,CAAAC,OAAA,CAAQ;EACvBC,OAAA,EAASC,QAAA,CAAOC,OAAA;EAAA;EAChBC,OAAA,EAAS;EACTC,MAAA,EAAQ;IACNC,IAAA,EAAM;IAAA;EACP;AACH,CAAC;;AAGDR,IAAA,CAAKS,YAAA,CAAaC,OAAA,CAAQC,GAAA,CAAI,UAACC,MAAA,EAAW;EACzC,IAAMC,SAAA,GAAYC,WAAA,CAAAC,YAAA,EAAc;EAChC,IAAIF,SAAA,CAAUG,KAAA,EAAO;IACjBJ,MAAA,CAAOK,MAAA,CAAOD,KAAA,GAAQH,SAAA,CAAUG,KAAA;EACjC;EAKFE,aAAA,CAAAC,KAAA,CAAIC,WAAA,CAAY;IACfC,KAAA,EAAO;EACV,CAAG;EACD,OAAOT,MAAA;AACT,GAAG,UAACU,KAAA,EAAU;EACZ,OAAOC,OAAA,CAAQC,MAAA,CAAOF,KAAK;AAC7B,CAAC;AAGDtB,IAAA,CAAKS,YAAA,CAAagB,QAAA,CAASd,GAAA,CAAI,UAACc,QAAA,EAAa;EAE3CP,aAAA,CAAAC,KAAA,CAAIO,WAAA,EAAa;EACjB,IAAID,QAAA,CAASE,IAAA,CAAKC,IAAA,KAAS,KAAKH,QAAA,CAASE,IAAA,CAAKC,IAAA,KAAS,KAAK;IAC1D,OAAOH,QAAA,CAASE,IAAA;EACpB,OAAS;IACLT,aAAA,CAAAC,KAAA,CAAIU,SAAA,CAAU;MACZR,KAAA,EAAOI,QAAA,CAASE,IAAA,CAAKG,GAAA,IAAO;MAC5BC,IAAA,EAAM;IACZ,CAAK;IACD,OAAOR,OAAA,CAAQC,MAAA,CAAOC,QAAA,CAASE,IAAI;EACpC;AACH,GAAG,UAACL,KAAA,EAAU;EACZJ,aAAA,CAAYC,KAAA,CAAAa,KAAA,uCAAAV,KAAA,CAAMW,UAAU;EAE5B,IAAIX,KAAA,CAAMW,UAAA,IAAc,KAAK;IAC1Bf,aAAA,CAAAC,KAAA,CAAIU,SAAA,CAAU;MACZR,KAAA,EAAO;MACPU,IAAA,EAAM;IACb,CAAM;IAEH,IAAMlB,SAAA,GAAYC,WAAA,CAAAC,YAAA,EAAc;IAC5BF,SAAA,CAAUqB,MAAA,EAAQ;IAErBhB,aAAA,CAAAC,KAAA,CAAIgB,QAAA,CAAS;MAAEC,GAAA,EAAK;IAAoB,CAAE;EAC9C,OAAO;IACJlB,aAAA,CAAAC,KAAA,CAAIU,SAAA,CAAU;MACZR,KAAA,EAAO;MACPU,IAAA,EAAM;IACX,CAAI;EACD;EAID,OAAOR,OAAA,CAAQC,MAAA,CAAOF,KAAK;AAC7B,CAAC;AAGI,IAACe,MAAA,GAAS;EACbC,OAAA,WAAAA,QAAQC,GAAA,EAAK;IACXA,GAAA,CAAI3B,MAAA,CAAO4B,gBAAA,CAAiBC,KAAA,GAAQzC,IAAA;IACpCkB,aAAA,CAAGC,KAAA,CAACsB,KAAA,GAAQzC,IAAA;EACb;AACH","ignoreList":[]}