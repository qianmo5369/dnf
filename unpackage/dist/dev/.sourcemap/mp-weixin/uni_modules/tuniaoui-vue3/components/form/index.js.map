{"version":3,"file":"index.js","sources":["uni_modules/tuniaoui-vue3/components/form/src/form.vue","uni_modules/tuniaoui-vue3/components/form/src/form-item.vue","uni_modules/tuniaoui-vue3/components/form/index.ts"],"sourcesContent":["<script lang=\"ts\" setup>\nimport { provide, reactive, toRefs, watch } from 'vue'\nimport { formContextKey } from '../../../tokens'\nimport { formEmits, formProps } from './form'\nimport { useForm, useFormCustomStyle } from './composables'\n\nconst props = defineProps(formProps)\nconst emits = defineEmits(formEmits)\n\nconst { formClass } = useFormCustomStyle()\nconst {\n  addField,\n  removeField,\n  resetFields,\n  clearValidate,\n  validate,\n  validateField,\n} = useForm(props)\n\nwatch(\n  () => props.rules,\n  () => {\n    if (props.validateOnRuleChange) validate()\n  },\n  {\n    deep: true,\n  }\n)\n\nprovide(\n  formContextKey,\n  reactive({\n    ...toRefs(props),\n    emits,\n\n    resetFields,\n    clearValidate,\n    validateField,\n    addField,\n    removeField,\n  })\n)\n\ndefineExpose({\n  /**\n   * @description 对整个表单的内容进行验证。 接收一个回调函数或返回Promise\n   */\n  validate,\n  /**\n   * @description 验证具体的某个字段\n   */\n  validateField,\n  /**\n   * @description 重置表单\n   */\n  resetFields,\n  /**\n   * @description 清除表单验证\n   */\n  clearValidate,\n})\n</script>\n\n<template>\n  <view :class=\"[formClass]\">\n    <slot />\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\n@import '../../../theme-chalk/src/form.scss';\n</style>\n","<script lang=\"ts\" setup>\nimport {\n  nextTick,\n  onBeforeUnmount,\n  onMounted,\n  provide,\n  reactive,\n  toRefs,\n  useSlots,\n} from 'vue'\nimport { formItemContextKey } from '../../../tokens'\nimport { formItemProps } from './form-item'\nimport {\n  useFormItemCustomStyle,\n  useFormItemOperation,\n  useFormSize,\n} from './composables'\n\nimport type { FormItemContext } from './types'\n\nconst props = defineProps(formItemProps)\n\nconst slots = useSlots()\n\nconst {\n  formContext,\n  validateState,\n  validateMessage,\n  hasLabel,\n  currentLabel,\n  shouldShowError,\n  isRequired,\n  resetField,\n  clearValidate,\n  validate,\n  initFieldValue,\n} = useFormItemOperation(props, slots)\nconst {\n  ns: formItemNs,\n  labelId,\n  formItemClass,\n  formItemLabelClass,\n  formItemLabelStyle,\n  formItemErrorMessageStyle,\n  initLabelContainerWidth,\n} = useFormItemCustomStyle(props, hasLabel, isRequired)\nconst _size = useFormSize(undefined, { formItem: false })\n\nconst context: FormItemContext = reactive({\n  ...toRefs(props),\n  size: _size,\n  validateState,\n  hasLabel,\n  resetField,\n  clearValidate,\n  validate,\n})\n\nonMounted(() => {\n  if (props.prop) {\n    formContext?.addField(context)\n    initFieldValue()\n  }\n  nextTick(() => {\n    initLabelContainerWidth()\n  })\n})\n\nonBeforeUnmount(() => {\n  formContext?.removeField(context)\n})\n\nprovide(formItemContextKey, context)\n\ndefineExpose({\n  /**\n   * @description 表单尺寸\n   */\n  size: _size,\n  /**\n   * @description 校验信息\n   */\n  validateMessage,\n  /**\n   * @description 校验状态\n   */\n  validateState,\n  /**\n   * @description 对表单Item的内容进行验证。 接收一个回调函数或返回Promise\n   */\n  validate,\n  /**\n   * @description 重置当前字段信息\n   */\n  resetField,\n  /**\n   * @description 清除表单字段验证\n   */\n  clearValidate,\n})\n</script>\n\n<template>\n  <view :class=\"[formItemClass]\">\n    <view :class=\"[formItemNs.e('wrapper')]\">\n      <!-- label -->\n      <view\n        v-if=\"hasLabel\"\n        :id=\"labelId\"\n        :class=\"[formItemLabelClass]\"\n        :style=\"formItemLabelStyle\"\n      >\n        <slot name=\"label\">\n          {{ currentLabel }}\n        </slot>\n      </view>\n      <!-- 表单组件 -->\n      <view :class=\"[formItemNs.e('content')]\">\n        <slot />\n      </view>\n    </view>\n    <!-- 错误信息 -->\n    <view\n      v-if=\"shouldShowError\"\n      class=\"tn-red_text\"\n      :class=\"[formItemNs.e('error-message')]\"\n      :style=\"formItemErrorMessageStyle\"\n    >\n      {{ validateMessage }}\n    </view>\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\n@import '../../../theme-chalk/src/form-item.scss';\n</style>\n","import { withInstall, withNoopInstall } from '../../utils'\nimport Form from './src/form.vue'\nimport FormItem from './src/form-item.vue'\n\nexport const TnForm = withInstall(Form, {\n  FormItem,\n})\nexport default TnForm\nexport const TnFormItem = withNoopInstall(FormItem)\n\nexport * from './src/form'\nexport * from './src/form-item'\nexport * from './src/types'\n\nexport * from './src/composables'\n\nexport type { TnFormInstance, TnFormItemInstance } from './src/instance'\n"],"names":["useFormCustomStyle","useForm","watch","provide","formContextKey","reactive","toRefs","useSlots","useFormItemOperation","useFormItemCustomStyle","useFormSize","onMounted","nextTick","onBeforeUnmount","formItemContextKey","withInstall","withNoopInstall"],"mappings":";;;;;;;;;;;;;;;;;;;AAMA,UAAM,QAAQ;AACd,UAAM,QAAQ;AAER,UAAA,EAAE,cAAcA,oEAAAA;AAChB,UAAA;AAAA,MACJ;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IAAA,IACEC,iEAAAA,QAAQ,KAAK;AAEjBC,kBAAA;AAAA,MACE,MAAM,MAAM;AAAA,MACZ,MAAM;AACJ,YAAI,MAAM;AAA+B;MAC3C;AAAA,MACA;AAAA,QACE,MAAM;AAAA,MACR;AAAA,IAAA;AAGFC,kBAAA;AAAA,MACEC,qCAAA;AAAA,MACAC,uBAAS;AAAA,QACP,GAAGC,cAAAA,OAAO,KAAK;AAAA,QACf;AAAA,QAEA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,QACA;AAAA,MAAA,CACD;AAAA,IAAA;AAGU,aAAA;AAAA;AAAA;AAAA;AAAA,MAIX;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA,IAAA,CACD;;;;;;;;;;;;;ACxCD,UAAM,QAAQ;AAEd,UAAM,QAAQC,cAAAA;AAER,UAAA;AAAA,MACJ;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IAAA,IACEC,8EAAqB,qBAAA,OAAO,KAAK;AAC/B,UAAA;AAAA,MACJ,IAAI;AAAA,MACJ;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACE,IAAAC,+FAAuB,OAAO,UAAU,UAAU;AACtD,UAAM,QAAQC,4EAAAA,YAAY,QAAW,EAAE,UAAU,OAAO;AAExD,UAAM,UAA2BL,cAAAA,SAAS;AAAA,MACxC,GAAGC,cAAAA,OAAO,KAAK;AAAA,MACf,MAAM;AAAA,MACN;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IAAA,CACD;AAEDK,kBAAAA,UAAU,MAAM;AACd,UAAI,MAAM,MAAM;AACd,mDAAa,SAAS;AACP;MACjB;AACAC,oBAAAA,WAAS,MAAM;AACW;MAAA,CACzB;AAAA,IAAA,CACF;AAEDC,kBAAAA,gBAAgB,MAAM;AACpB,iDAAa,YAAY;AAAA,IAAO,CACjC;AAEDV,0BAAQW,qCAAAA,oBAAoB,OAAO;AAEtB,aAAA;AAAA;AAAA;AAAA;AAAA,MAIX,MAAM;AAAA;AAAA;AAAA;AAAA,MAIN;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA;AAAA;AAAA;AAAA,MAIA;AAAA,IAAA,CACD;;;;;;;;;;;;;;;;;;;;;;;;AC/FqBC,uDAAY,MAAM;AAAA,EACtC;AACF,CAAC;AAEyBC,2CAAAA,gBAAgB,QAAQ;"}