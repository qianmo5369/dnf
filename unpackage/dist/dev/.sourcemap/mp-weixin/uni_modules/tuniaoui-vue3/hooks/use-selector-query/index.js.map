{"version":3,"file":"index.js","sources":["uni_modules/tuniaoui-vue3/hooks/use-selector-query/index.ts"],"sourcesContent":["import { getCurrentInstance } from 'vue'\nimport { debugWarn } from '../../utils'\n\nimport type { ComponentInternalInstance } from 'vue'\n\nexport const useSelectorQuery = (\n  instance?: ComponentInternalInstance | null\n) => {\n  let query: UniApp.SelectorQuery | null = null\n\n  if (!instance) {\n    instance = getCurrentInstance()\n  }\n  if (!instance) {\n    debugWarn('useSelectorQuery', 'useSelectorQuery必须在setup函数中使用')\n  }\n\n  // #ifndef MP-ALIPAY\n  query = uni.createSelectorQuery().in(instance)\n  // #endif\n  // #ifdef APP-PLUS\n  // query = uni.createSelectorQuery().in((instance as any).ctx.$scope)\n  // #endif\n  // #ifdef MP-ALIPAY\n  query = uni.createSelectorQuery().in(null)\n  // #endif\n\n  const getSelectorNodeInfo = (selector: string): Promise<UniApp.NodeInfo> => {\n    return new Promise((resolve, reject) => {\n      if (query) {\n        query\n          .select(selector)\n          .boundingClientRect((res) => {\n            const selectRes: UniApp.NodeInfo = res as UniApp.NodeInfo\n            if (selectRes) {\n              resolve(selectRes)\n            } else {\n              reject(new Error(`未找到对应节点: ${selector}`))\n            }\n          })\n          .exec()\n      } else {\n        reject(new Error('未找到对应的SelectorQuery实例'))\n      }\n    })\n  }\n\n  const getSelectorNodeInfos = (\n    selector: string\n  ): Promise<UniApp.NodeInfo[]> => {\n    return new Promise((resolve, reject) => {\n      if (query) {\n        query\n          .selectAll(selector)\n          .boundingClientRect((res) => {\n            const selectRes: UniApp.NodeInfo[] = res as UniApp.NodeInfo[]\n            if (selectRes && selectRes.length > 0) {\n              resolve(selectRes)\n            } else {\n              reject(new Error(`未找到对应节点: ${selector}`))\n            }\n          })\n          .exec()\n      } else {\n        reject(new Error('未找到对应的SelectorQuery实例'))\n      }\n    })\n  }\n\n  return {\n    query,\n    getSelectorNodeInfo,\n    getSelectorNodeInfos,\n  }\n}\n"],"names":["getCurrentInstance","debugWarn","uni"],"mappings":";;;;AAKa,MAAA,mBAAmB,CAC9B,aACG;AACH,MAAI,QAAqC;AAEzC,MAAI,CAAC,UAAU;AACb,eAAWA,cAAmB,mBAAA;AAAA,EAChC;AACA,MAAI,CAAC,UAAU;AACbC,mDAAU,oBAAoB,+BAA+B;AAAA,EAC/D;AAGA,UAAQC,cAAAA,MAAI,oBAAsB,EAAA,GAAG,QAAQ;AASvC,QAAA,sBAAsB,CAAC,aAA+C;AAC1E,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,UAAI,OAAO;AACT,cACG,OAAO,QAAQ,EACf,mBAAmB,CAAC,QAAQ;AAC3B,gBAAM,YAA6B;AACnC,cAAI,WAAW;AACb,oBAAQ,SAAS;AAAA,UAAA,OACZ;AACL,mBAAO,IAAI,MAAM,YAAY,QAAQ,EAAE,CAAC;AAAA,UAC1C;AAAA,QAAA,CACD,EACA,KAAK;AAAA,MAAA,OACH;AACE,eAAA,IAAI,MAAM,uBAAuB,CAAC;AAAA,MAC3C;AAAA,IAAA,CACD;AAAA,EAAA;AAGG,QAAA,uBAAuB,CAC3B,aAC+B;AAC/B,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,UAAI,OAAO;AACT,cACG,UAAU,QAAQ,EAClB,mBAAmB,CAAC,QAAQ;AAC3B,gBAAM,YAA+B;AACjC,cAAA,aAAa,UAAU,SAAS,GAAG;AACrC,oBAAQ,SAAS;AAAA,UAAA,OACZ;AACL,mBAAO,IAAI,MAAM,YAAY,QAAQ,EAAE,CAAC;AAAA,UAC1C;AAAA,QAAA,CACD,EACA,KAAK;AAAA,MAAA,OACH;AACE,eAAA,IAAI,MAAM,uBAAuB,CAAC;AAAA,MAC3C;AAAA,IAAA,CACD;AAAA,EAAA;AAGI,SAAA;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ;;"}