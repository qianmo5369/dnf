{"version":3,"file":"fui-upload.js","sources":["components/fui-upload.vue","/Users/zhizhi/Documents/HBuilderProjects/dnf/components/fui-upload.vue?type=component"],"sourcesContent":["<template>\r\n\t<view class=\"fui-upload__wrap\">\r\n\t\t<view class=\"fui-upload__item\" :style=\"{width:width+'rpx',height:height+'rpx',borderRadius:radius+'rpx'}\"\r\n\t\t\tv-for=\"(item,index) in urls\" :key=\"index\">\r\n\t\t\t<image class=\"fui-upload__img\" :style=\"{width:width+'rpx',height:height+'rpx',borderRadius:radius+'rpx'}\"\r\n\t\t\t\t:src=\"item\" mode=\"aspectFill\" @tap.stop=\"previewImage(index)\"></image>\r\n\t\t\t<view class=\"fui-upload__mask\" v-if=\"status[index]!=='success' && status[index]!=='preupload' \">\r\n\t\t\t\t<fui-icon name=\"warning-fill\" color=\"#fff\" :size=\"48\" v-if=\"status[index]==='error'\"></fui-icon>\r\n\t\t\t\t<text class=\"fui-reupload__btn\" @tap.stop=\"reUpload(index)\" v-if=\"status[index]==='error'\">重新上传</text>\r\n\t\t\t\t<!-- #ifndef APP-NVUE -->\r\n\t\t\t\t<view class=\"fui-upload__loading\" ref=\"fui_reupload_ld\" v-if=\"status[index]==='uploading'\"></view>\r\n\t\t\t\t<text class=\"fui-upload__text\" v-if=\"status[index]==='uploading'\">请稍候...</text>\r\n\t\t\t\t<!-- #endif -->\r\n\t\t\t\t<!-- #ifdef APP-NVUE -->\r\n\t\t\t\t<text class=\"fui-upload__text fui-upload__mtop\" v-if=\"status[index]==='uploading'\">正在上传...</text>\r\n\t\t\t\t<!-- #endif -->\r\n\t\t\t</view>\r\n\t\t\t<view class=\"fui-upload__del\" :style=\"{background:delColor}\" v-if=\"isDel\" @tap.stop=\"deleteImage(index)\">\r\n\t\t\t\t<fui-icon name=\"close\" color=\"#fff\" :size=\"32\"></fui-icon>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"fui-upload__item\"\r\n\t\t\t:class=\"[borderColor && borderColor!==true?'fui-upload__border':'fui-upload__noborder']\"\r\n\t\t\t:style=\"{width:width+'rpx',height:height+'rpx',background:background,borderRadius:radius+'rpx',borderColor:borderColor,borderStyle:borderSytle}\"\r\n\t\t\tv-if=\"showAdd\" @tap.stop=\"chooseImage\">\r\n\t\t\t<slot>\n\t\t\t\t\t<view style=\"display: flex;flex-direction: column;align-items: center;\">\n\t\t\t\t\t\t<fui-icon name=\"plus\" :size=\"addSize\" :color=\"addColor\"></fui-icon>\n\t\t\t\t\t\t<view  style=\"color: #000;\">点击上传</view>\n\t\t\t\t\t</view>\n\t\t\t\t\r\n\t\t\t</slot>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\t//非easycom模式取消注释引入字体组件，按实际路径进行调整\r\n\timport fuiIcon from \"@/components/fui-icon/fui-icon.vue\"\r\n\texport default {\r\n\t\tname: \"fui-upload\",\r\n\t\temits: ['success', 'error', 'complete', 'preview', 'reupload', 'delete'],\r\n\t\t// components:{\r\n\t\t// \tfuiIcon\r\n\t\t// },\r\n\t\tprops: {\r\n\t\t\twidth: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 200\r\n\t\t\t},\r\n\t\t\theight: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 200\r\n\t\t\t},\r\n\t\t\tfileList: {\r\n\t\t\t\ttype: Array,\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmax: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 9\r\n\t\t\t},\r\n\t\t\tisAdd: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\taddColor: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '#333'\r\n\t\t\t},\r\n\t\t\taddSize: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 88\r\n\t\t\t},\r\n\t\t\tbackground: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: '#eee'\r\n\t\t\t},\r\n\t\t\tradius: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 0\r\n\t\t\t},\r\n\t\t\tborderColor: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: ''\r\n\t\t\t},\r\n\t\t\t//solid、dashed、dotted\r\n\t\t\tborderSytle: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'solid'\r\n\t\t\t},\r\n\t\t\tisDel: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true\r\n\t\t\t},\r\n\t\t\tdelColor: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'rgba(0,0,0,.6)'\r\n\t\t\t},\r\n\t\t\tconfirmDel: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\turl: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: ''\r\n\t\t\t},\r\n\t\t\timmediate: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\t//V1.9.8+ 是否调用upload 方法进行上传操作\r\n\t\t\tcallUpload: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false\r\n\t\t\t},\r\n\t\t\tsizeType: {\r\n\t\t\t\ttype: Array,\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn ['original', 'compressed']\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsourceType: {\r\n\t\t\t\ttype: Array,\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn ['album', 'camera']\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//图片后缀名限制\r\n\t\t\tsuffix: {\r\n\t\t\t\ttype: Array,\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn []\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t//单张图片大小限制 MB\r\n\t\t\tsize: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 4\r\n\t\t\t},\r\n\t\t\tname: {\r\n\t\t\t\ttype: String,\r\n\t\t\t\tdefault: 'file'\r\n\t\t\t},\r\n\t\t\theader: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn {}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tformData: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault () {\r\n\t\t\t\t\treturn {}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tparam: {\r\n\t\t\t\ttype: [Number, String],\r\n\t\t\t\tdefault: 0\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\turls: [],\r\n\t\t\t\ttempFiles: [],\r\n\t\t\t\t//preupload、uploading、success、error\r\n\t\t\t\tstatus: []\r\n\t\t\t};\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.initData(this.fileList)\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tfileList(vals) {\r\n\t\t\t\tthis.initData(vals)\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tshowAdd() {\r\n\t\t\t\tlet show = true;\r\n\t\t\t\tlet len = this.urls.length\r\n\t\t\t\tif (!this.isAdd || (this.max == -1 && len >= 9) || (this.max != -1 && len >= this.max)) {\r\n\t\t\t\t\tshow = false\r\n\t\t\t\t}\r\n\t\t\t\treturn show\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tinitData(urls) {\r\n\t\t\t\turls = urls || []\r\n\t\t\t\tthis.status = [];\r\n\t\t\t\tlet status = [];\r\n\t\t\t\tlet tempFiles = []\r\n\t\t\t\turls.forEach(item => {\r\n\t\t\t\t\tstatus.push('success')\r\n\t\t\t\t\ttempFiles.push({\r\n\t\t\t\t\t\tpath: item\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\tthis.urls = [...urls];\r\n\t\t\t\tthis.tempFiles = tempFiles;\r\n\t\t\t\tthis.status = status;\r\n\t\t\t},\r\n\t\t\treUpload(index) {\r\n\t\t\t\tthis.$set(this.status, index, 'uploading')\r\n\t\t\t\tif (this.callUpload) {\r\n\t\t\t\t\tthis.$emit('reupload', {\r\n\t\t\t\t\t\tindex\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.uploadImage(index, this.urls[index]).then((res) => {\r\n\t\t\t\t\t\tthis._success(res)\r\n\t\t\t\t\t}).catch((res) => {\r\n\t\t\t\t\t\tthis._error(res)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetStatus() {\r\n\t\t\t\tif (this.status.length === 0) return '';\r\n\t\t\t\tlet status = 'preupload';\r\n\t\t\t\tif (this.status.indexOf('preupload') === -1) {\r\n\t\t\t\t\tstatus = ~this.status.indexOf('uploading') ? 'uploading' : 'success'\r\n\t\t\t\t\tif (status !== 'uploading' && ~this.status.indexOf(\"error\")) {\r\n\t\t\t\t\t\t// 上传失败\r\n\t\t\t\t\t\tstatus = 'error'\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn status\r\n\t\t\t},\r\n\t\t\tonComplete(action) {\r\n\t\t\t\tlet status = this.getStatus()\r\n\t\t\t\tthis.$emit('complete', {\r\n\t\t\t\t\tstatus: status,\r\n\t\t\t\t\turls: this.urls,\r\n\t\t\t\t\ttempFiles: this.tempFiles,\r\n\t\t\t\t\taction: action,\r\n\t\t\t\t\tparam: this.param\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t_success(res) {\r\n\t\t\t\tlet status = this.getStatus()\r\n\t\t\t\tthis.$emit('success', {\r\n\t\t\t\t\tstatus: status,\r\n\t\t\t\t\t...res,\r\n\t\t\t\t\tparam: this.param\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t_error(res) {\r\n\t\t\t\tlet status = this.getStatus()\r\n\t\t\t\tthis.$emit('error', {\r\n\t\t\t\t\tstatus: status,\r\n\t\t\t\t\t...res,\r\n\t\t\t\t\tparam: this.param\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tresult(url, index) {\r\n\t\t\t\tif (!url || index === undefined) return;\r\n\t\t\t\tthis.$set(this.urls, index, url)\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.onComplete('upload')\r\n\t\t\t\t}, 0)\r\n\t\t\t},\r\n\t\t\ttoast(text) {\r\n\t\t\t\ttext && uni.showToast({\r\n\t\t\t\t\ttitle: text,\r\n\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tchooseImage() {\r\n\t\t\t\tlet max = Number(this.max)\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: max === -1 ? 9 : max - this.urls.length,\r\n\t\t\t\t\tsizeType: this.sizeType,\r\n\t\t\t\t\tsourceType: this.sourceType,\r\n\t\t\t\t\tsuccess: (e) => {\r\n\t\t\t\t\t\tlet imageArr = [];\r\n\t\t\t\t\t\tfor (let i = 0; i < e.tempFiles.length; i++) {\r\n\t\t\t\t\t\t\tlet len = this.urls.length;\r\n\t\t\t\t\t\t\tif (len >= max && max !== -1) {\r\n\t\t\t\t\t\t\t\tthis.toast(`最多可上传${max}张图片`);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t//过滤图片类型\r\n\t\t\t\t\t\t\tlet path = e.tempFiles[i].path;\r\n\r\n\t\t\t\t\t\t\tif (this.suffix.length > 0) {\r\n\t\t\t\t\t\t\t\tlet format = \"\"\r\n\t\t\t\t\t\t\t\t// #ifdef H5\r\n\t\t\t\t\t\t\t\tlet type = e.tempFiles[i].type;\r\n\t\t\t\t\t\t\t\tformat = type.split('/')[1]\r\n\t\t\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\t\t\t// #ifndef H5\r\n\t\t\t\t\t\t\t\tformat = path.split(\".\")[(path.split(\".\")).length - 1];\r\n\t\t\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\t\t\tif (this.suffix.indexOf(format) == -1) {\r\n\t\t\t\t\t\t\t\t\tlet text = `只能上传 ${this.suffix.join(',')} 格式图片！`\r\n\t\t\t\t\t\t\t\t\tthis.toast(text);\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t//过滤超出大小限制图片\r\n\t\t\t\t\t\t\tlet size = e.tempFiles[i].size;\r\n\r\n\t\t\t\t\t\t\tif (Number(this.size) * 1024 * 1024 < size) {\r\n\t\t\t\t\t\t\t\tlet err = `单张图片大小不能超过：${this.size}MB`\r\n\t\t\t\t\t\t\t\tthis.toast(err);\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\timageArr.push(path)\r\n\t\t\t\t\t\t\tthis.urls.push(path)\r\n\t\t\t\t\t\t\tthis.tempFiles.push(e.tempFiles[i])\r\n\t\t\t\t\t\t\tthis.status.push(this.immediate ? 'uploading' : 'preupload')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.onComplete('choose')\r\n\t\t\t\t\t\tlet start = this.urls.length - imageArr.length\r\n\t\t\t\t\t\tif (this.immediate) {\r\n\t\t\t\t\t\t\tfor (let j = 0; j < imageArr.length; j++) {\r\n\t\t\t\t\t\t\t\tlet index = start + j\r\n\t\t\t\t\t\t\t\tthis.uploadImage(index, imageArr[j]).then((res) => {\r\n\t\t\t\t\t\t\t\t\tthis._success(res)\r\n\t\t\t\t\t\t\t\t}).catch((res) => {\r\n\t\t\t\t\t\t\t\t\tthis._error(res)\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tuploadImage(index, imgUrl, url) {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tuni.uploadFile({\r\n\t\t\t\t\t\turl: this.url || url,\r\n\t\t\t\t\t\tname: this.name,\r\n\t\t\t\t\t\theader: this.header,\r\n\t\t\t\t\t\tformData: this.formData,\r\n\t\t\t\t\t\tfilePath: imgUrl,\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tif (res.statusCode === 200) {\r\n\t\t\t\t\t\t\t\tthis.$set(this.status, index, 'success')\r\n\t\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\t\tres,\r\n\t\t\t\t\t\t\t\t\tindex\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.$set(this.status, index, 'error')\r\n\t\t\t\t\t\t\t\treject({\r\n\t\t\t\t\t\t\t\t\tres,\r\n\t\t\t\t\t\t\t\t\tindex\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: (res) => {\r\n\t\t\t\t\t\t\tthis.$set(this.status, index, 'error')\r\n\t\t\t\t\t\t\t// uni.showModal({\r\n\t\t\t\t\t\t\t// \tcontent: JSON.stringify(res)\r\n\t\t\t\t\t\t\t// })\r\n\t\t\t\t\t\t\treject({\r\n\t\t\t\t\t\t\t\tres,\r\n\t\t\t\t\t\t\t\tindex\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tdeleteImage(index) {\r\n\t\t\t\tlet status = this.getStatus()\r\n\t\t\t\tif (status === 'uploading') {\r\n\t\t\t\t\tthis.toast('请等待上传结束再进行删除！')\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.confirmDel) {\r\n\t\t\t\t\t\tlet _this = this\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: '确定将该图片删除吗？',\r\n\t\t\t\t\t\t\tshowCancel: true,\r\n\t\t\t\t\t\t\tconfirmText: \"确定\",\r\n\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t_this.urls.splice(index, 1)\r\n\t\t\t\t\t\t\t\t\t_this.tempFiles.splice(index, 1)\r\n\t\t\t\t\t\t\t\t\t_this.status.splice(index, 1)\r\n\t\t\t\t\t\t\t\t\t_this.onComplete('delete')\r\n\t\t\t\t\t\t\t\t\t_this.$emit('delete', {\r\n\t\t\t\t\t\t\t\t\t\tindex: index\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.urls.splice(index, 1)\r\n\t\t\t\t\t\tthis.tempFiles.splice(index, 1)\r\n\t\t\t\t\t\tthis.status.splice(index, 1)\r\n\t\t\t\t\t\tthis.onComplete('delete')\r\n\t\t\t\t\t\tthis.$emit('delete', {\r\n\t\t\t\t\t\t\tindex: index\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tpreviewImage(index) {\r\n\t\t\t\t// #ifndef MP-BAIDU\r\n\t\t\t\tif (this.status.length === 0) return;\r\n\t\t\t\t// uni.previewImage({\r\n\t\t\t\t// \tcurrent: this.urls[index],\r\n\t\t\t\t// \tloop: true,\r\n\t\t\t\t// \turls: this.urls\r\n\t\t\t\t// })\r\n\t\t\t\t// #endif\r\n\t\t\t\t//百度小程序使用\r\n\t\t\t\tthis.$emit('preview', {\r\n\t\t\t\t\tindex: index,\r\n\t\t\t\t\turls: this.urls\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tstart() {\r\n\t\t\t\tif (!this.url) {\r\n\t\t\t\t\tthis.toast('请传入服务器接口地址！');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlet urls = [...this.urls]\r\n\t\t\t\tconst len = urls.length\r\n\t\t\t\tfor (let i = 0; i < len; i++) {\r\n\t\t\t\t\tif (urls[i].startsWith('https')) {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$set(this.status, i, \"uploading\")\r\n\t\t\t\t\t\tthis.uploadImage(i, urls[i], this.url).then(res => {\r\n\t\t\t\t\t\t\tthis._success(res)\r\n\t\t\t\t\t\t}).catch(error => {\r\n\t\t\t\t\t\t\tthis._error(error)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tupload(callback, index) {\r\n\t\t\t\t// 传入一个返回Promise的文件上传的函数\r\n\t\t\t\t//V1.9.8+，新增此方法主要为了更好的扩展使用\r\n\t\t\t\tif (index === undefined || index === null) {\r\n\t\t\t\t\tlet urls = [...this.urls]\r\n\t\t\t\t\tconst len = urls.length\r\n\t\t\t\t\tfor (let i = 0; i < len; i++) {\r\n\t\t\t\t\t\tif (urls[i].startsWith('https')) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.$set(this.status, i, \"uploading\")\r\n\t\t\t\t\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\t\t\t\t\tcallback(this.tempFiles[i]).then(res => {\r\n\t\t\t\t\t\t\t\t\tthis.$set(this.status, i, 'success')\r\n\t\t\t\t\t\t\t\t\tthis.result(res, i)\r\n\t\t\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\t\t\tthis.$set(this.status, i, 'error')\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//如果传入index，则是重新上传时调用\r\n\t\t\t\t\tthis.$set(this.status, index, \"uploading\")\r\n\t\t\t\t\tif (typeof callback === 'function') {\r\n\t\t\t\t\t\tcallback(this.tempFiles[index]).then(res => {\r\n\t\t\t\t\t\t\tthis.$set(this.status, index, 'success')\r\n\t\t\t\t\t\t\tthis.result(res, index)\r\n\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\tthis.$set(this.status, index, 'error')\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.fui-upload__wrap {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\tflex-direction: row;\r\n\t\tflex-wrap: wrap;\r\n\t}\r\n\r\n\t.fui-upload__item {\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-right: 20rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\t/* #ifdef H5 */\r\n\t\tcursor: pointer;\r\n\t\t/* #endif */\r\n\t\tposition: relative;\r\n\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tbox-sizing: border-box;\r\n\t\t/* #endif */\r\n\t}\r\n\r\n\t.fui-upload__noborder {\r\n\t\tborder-width: 0;\r\n\t}\r\n\r\n\t.fui-upload__border {\r\n\t\tborder-width: 1px;\r\n\t}\r\n\r\n\t.fui-upload__del {\r\n\t\tposition: absolute;\r\n\t\ttop: 8rpx;\r\n\t\tright: 8rpx;\r\n\t\theight: 40rpx;\r\n\t\twidth: 40rpx;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tborder-radius: 50%;\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\r\n\t\t/* #ifdef APP-NVUE */\r\n\t\tborder-radius: 20rpx;\r\n\t\t/* #endif */\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tz-index: 10;\r\n\t}\r\n\r\n\t.fui-upload__mask {\r\n\t\tposition: absolute;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\ttop: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground: rgba(0, 0, 0, .6);\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.fui-reupload__btn {\r\n\t\twidth: 144rpx;\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tdisplay: flex;\r\n\t\t/* #endif */\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\ttext-align: center;\r\n\t\tpadding: 4rpx 0;\r\n\t\tfont-size: 24rpx;\r\n\t\tborder: 1px solid #FFFFFF;\r\n\t\tcolor: #fff;\r\n\t\tborder-radius: 32rpx;\r\n\t\tmargin-top: 16rpx;\r\n\t\tfont-weight: normal;\r\n\t}\r\n\r\n\t.fui-reupload__btn:active {\r\n\t\topacity: .5;\r\n\t}\r\n\r\n\t.fui-upload__loading {\r\n\t\twidth: 32rpx;\r\n\t\theight: 32rpx;\r\n\t\tborder-width: 2px;\r\n\t\tborder-style: solid;\r\n\t\tborder-top-color: #FFFFFF;\r\n\t\tborder-left-color: #7F7F7F;\r\n\t\tborder-right-color: #7F7F7F;\r\n\t\tborder-bottom-color: #7F7F7F;\r\n\t\t/* #ifdef APP-NVUE */\r\n\t\tborder-radius: 20rpx;\r\n\t\t/* #endif */\r\n\t\t/* #ifndef APP-NVUE */\r\n\t\tborder-radius: 50%;\r\n\t\tanimation: fui-rotate 0.7s linear infinite;\r\n\t\t/* #endif */\r\n\t\tmargin-bottom: 8rpx;\r\n\t}\r\n\r\n\t.fui-upload__text {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #fff;\r\n\t\tmargin-top: 16rpx;\r\n\t\tfont-weight: normal;\r\n\t}\r\n\r\n\t/* #ifdef APP-NVUE */\r\n\t.fui-upload__mtop {\r\n\t\tmargin-top: 0;\r\n\t}\r\n\r\n\t/* #endif */\r\n\r\n\t/* #ifndef APP-NVUE */\r\n\t@keyframes fui-rotate {\r\n\t\t0% {\r\n\t\t\ttransform: rotate(0);\r\n\t\t}\r\n\r\n\t\t100% {\r\n\t\t\ttransform: rotate(360deg);\r\n\t\t}\r\n\t}\r\n\r\n\t/* #endif */\r\n</style>","import Component from '/Users/zhizhi/Documents/HBuilderProjects/dnf/components/fui-upload.vue'\nwx.createComponent(Component)"],"names":["uni"],"mappings":"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"}