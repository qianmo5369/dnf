{"version":3,"file":"balance.js","sources":["pages/user/balance.vue","pages/user/balance.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"balance-page\">\r\n\r\n\t\t<TnPopup :model-value=\"rechargeShow\" width=\"80%\" height=\"400rpx\" borderRadius=\"16rpx\">\r\n\t\t\t<view class=\"recharge-card-box\">\r\n\t\t\t\t<view class=\"popup-header\">余额充值</view>\r\n\t\t\t\t<view class=\"fui-icon__close\" @tap=\"rechargeShow = false;amount = null\">\r\n\t\t\t\t\t<TnIcon name=\"close\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"pay-input-box\">\r\n\t\t\t\t\t<view class=\"input-title\">\r\n\t\t\t\t\t\t充值未使用的余额可以申请退款\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"input-box\">\r\n\t\t\t\t\t\t<text class=\"yuan-text\">￥</text>\r\n\t\t\t\t\t\t<input class=\"input\" type=\"text\" v-model=\"amount\" placeholder=\"请输入充值金额\" />\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"recharge-btn\" @tap=\"doRecharge()\">\r\n\t\t\t\t\t确认充值\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</TnPopup>\r\n\r\n\t\t<!-- 顶部余额卡片 -->\r\n\t\t<view class=\"balance-card\">\r\n\t\t\t<view class=\"balance-left\">\r\n\t\t\t\t<view class=\"label\">账号余额（元）</view>\r\n\t\t\t\t<view class=\"amount\">{{ balance }}</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"balance-right\" @click=\"goWithdraw\">去提现</view>\r\n\t\t\t<view class=\"balance-right btn-charge\" @tap=\"onCharge\">去充值</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 收支明细标题 -->\r\n\t\t<view class=\"section-title\">收支明细</view>\r\n\r\n\t\t<!-- 明细列表 -->\r\n\t\t<view class=\"record-list\">\n\t\t\t<z-paging\n\t\t\t  ref=\"paging\"\n\t\t\t  v-model=\"fundList\"\n\t\t\t  @query=\"getFundLogs\"\n\t\t\t\t:fixed=\"false\"\n\t\t\t>\r\n\t\t\t<view class=\"record-item\" v-for=\"(item,index) in fundList\" :key=\"item.id\">\r\n\t\t\t\t<view class=\"left\">\r\n\t\t\t\t\t<view class=\"title\">\n\t\t\t\t\t\t{{item.remark}}\n\t\t\t\t\t\t<!-- <text v-if=\"item.type == 'recharge'\">充值</text> -->\r\n\t\t\t\t\t\t <text class=\"tip\" v-if=\"item.tip\">?</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"desc\">余额：{{ item.balance }}</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"right\">\r\n\t\t\t\t\t<view :class=\"['amount', item.direction == 'in' ? 'positive' : 'negative']\">\r\n\t\t\t\t\t\t{{ item.direction  == 'in' ? '+' : '' }}{{ item.amount }}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<!-- <view class=\"time\">{{ item.time }}</view> -->\r\n\t\t\t\t</view>\r\n\t\t\t</view>\n\t\t\t</z-paging>\r\n\t\t</view>\r\n\r\n\t\t<!-- 充值按钮 -->\r\n\t\t<!-- <view class=\"btn-footer\">\r\n\t\t\t<view class=\"btn-charge\" @click=\"onCharge\">充值</view>\r\n\t\t</view> -->\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\n\timport useZPaging from \"@/uni_modules/z-paging/components/z-paging/js/hooks/useZPaging.js\";\r\n\timport {\r\n\t\tref\r\n\t} from 'vue'\r\n\timport TnIcon from '@/uni_modules/tuniaoui-vue3/components/icon/src/icon.vue'\r\n\timport TnPopup from '@/uni_modules/tuniaoui-vue3/components/popup/src/popup.vue';\n\tconst paging = ref(null)\n\tuseZPaging(paging)\r\n\tconst balance = ref(null)\r\n\tconst amount = ref(null)\r\n\tconst rechargeShow = ref(false)\r\n\t\n\t\n\tconst fundList = ref([])\n\t\n\tconst getFundLogs = async (pageNo, pageSize) => {\n\t  const res = await uni.$http.post('/dungeon/fundLogs', {\n\t    page: pageNo,\n\t    page_size: pageSize\n\t  })\n\t  if (res.code === 1) {\n\t    balance.value = res.data.balance\n\t    paging.value.complete(res.data.list)\n\t  } else {\n\t    paging.value.complete(false)\n\t  }\n\t}\n\t\n\t\r\n\r\n\tconst goWithdraw = () => {\r\n\t\t// uni.navigateTo({\r\n\t\t// \turl: '/pages/withdraw/index'\r\n\t\t// })\r\n\t\tuni.showToast({\r\n\t\t\ttitle: '暂无提现接口',\r\n\t\t\ticon: 'none'\r\n\t\t})\r\n\t}\r\n\r\n\tconst doRecharge = async () => {\r\n\t\tif (amount.value <= 0) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请输入充值金额',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn false;\r\n\t\t}\n\t\t\n\t\t// // #ifdef H5\n\t\t//     uni.showToast({\n\t\t//     \ttitle: '未配置h5支付',\n\t\t//     \ticon: 'none'\n\t\t//     })\n\t\t// \treturn false;\n\t\t// // #endif\n\n\t\t\r\n\t\tconst res = await uni.$http.post('/dungeon/recharge', {\r\n\t\t\tamount: amount.value\r\n\t\t})\r\n\t\tif (res.code === 1) {\r\n\t\t\t\n\t\t\tuni.requestPayment({\n\t\t\t appId: res.data.result.appId,\n\t\t\t timeStamp: res.data.result.timeStamp,\n\t\t\t nonceStr: res.data.result.nonceStr,\n\t\t\t package: res.data.result.package,\n\t\t\t signType: res.data.result.signType,\n\t\t\t paySign: res.data.result.paySign,\n\t\t\t success: (res) => {\n\t\t\t  uni.showToast({\n\t\t\t  \ttitle: '已完成支付',\n\t\t\t  \ticon: 'none'\n\t\t\t  })\n\t\t\t  // getInfo();\n\t\t\t  paging.value.reload();\n\t\t\t  rechargeShow.value = false;\n\t\t\t },\n\t\t\t fail: (err) => {\n\t\t\t  console.log(err)\n\t\t\t  uni.showToast({\n\t\t\t  \ttitle: '未付款',\n\t\t\t  \ticon: 'none'\n\t\t\t  })\n\t\t\t }\n\t\t\t});\r\n\t\t\t// 可刷新房间状态或跳转\r\n\t\t} else {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: res.msg || '请求支付错误',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\r\n\r\n\t}\r\n\r\n\tconst onCharge = () => {\r\n\t\trechargeShow.value = true\r\n\t\t// uni.navigateTo({ url: '/pages/charge/index' })\r\n\t}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n\t.balance-page {\r\n\t\tposition: relative;\r\n\t\t// height: 100vh;\r\n\t\t/* background: #f6f6f6; */\r\n\t\t/* min-height: 100vh; */\r\n\t\t/* display: flex;\r\n  flex-direction: column; */\r\n\t}\r\n\r\n\t.balance-card {\r\n\t\tbackground: url(\"https://dnf.hanyunkeji.cn/static/user/card.png\");\r\n\t\theight: 300rpx;\r\n\t\tbackground-size: 100% 100%;\r\n\t\tmargin: 30rpx;\r\n\t\t/* border-bottom-left-radius: 24rpx;\r\n  border-bottom-right-radius: 24rpx; */\r\n\t\tpadding: 40rpx 30rpx;\r\n\t\tcolor: #fff;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.balance-left .label {\r\n\t\tdisplay: block;\r\n\t\tfont-size: 28rpx;\r\n\t\topacity: 0.9;\r\n\t}\r\n\r\n\t.balance-left .amount {\r\n\t\tfont-size: 52rpx;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-top: 32rpx;\r\n\t}\r\n\r\n\t.balance-right {\r\n\t\tposition: absolute;\r\n\t\tbackground: #ffffff;\r\n\t\tcolor: #1e90ff;\r\n\t\tfont-size: 26rpx;\r\n\t\tpadding: 12rpx 32rpx;\r\n\t\tborder-top-left-radius: 32rpx;\r\n\t\tborder-bottom-left-radius: 32rpx;\r\n\t\tright: 0;\r\n\t\ttop: 80rpx;\r\n\t}\r\n\r\n\r\n\t.btn-charge {\r\n\t\tright: 0;\r\n\t\tbackground-color: #3366ff;\r\n\t\tcolor: #fff;\r\n\t\ttop: 180rpx;\r\n\t}\r\n\r\n\t.section-title {\r\n\t\tpadding: 30rpx;\r\n\t\tfont-size: 30rpx;\r\n\t\tfont-weight: bold;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.record-list {\r\n\t\tpadding: 0 24rpx;\n\t\theight: 60vh;\r\n\t}\r\n\r\n\t.record-item {\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 24rpx;\r\n\t\tmargin-bottom: 20rpx;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: flex-start;\r\n\t\tbox-shadow: 0 8rpx 12rpx rgba(0, 0, 0, 0.04);\r\n\t}\r\n\r\n\t.record-item .title {\r\n\t\tfont-size: 28rpx;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.record-item .desc {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999;\r\n\t\tmargin-top: 8rpx;\r\n\t}\r\n\r\n\t.tip {\r\n\t\tfont-size: 20rpx;\r\n\t\tbackground: #eee;\r\n\t\tborder-radius: 50%;\r\n\t\twidth: 28rpx;\r\n\t\theight: 28rpx;\r\n\t\tdisplay: inline-flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tmargin-left: 10rpx;\r\n\t\tcolor: #888;\r\n\t}\r\n\r\n\t.right .amount {\r\n\t\tfont-size: 30rpx;\r\n\t\tfont-weight: bold;\r\n\t\ttext-align: right;\r\n\t}\r\n\r\n\t.positive {\r\n\t\tcolor: #12c279;\r\n\t}\r\n\r\n\t.negative {\r\n\t\tcolor: red;\r\n\t}\r\n\r\n\t.right .time {\r\n\t\tfont-size: 22rpx;\r\n\t\tcolor: #999;\r\n\t\tmargin-top: 10rpx;\r\n\t\ttext-align: right;\r\n\t}\r\n\r\n\t.btn-footer {\r\n\t\twidth: 100%;\r\n\t\tposition: absolute;\r\n\t\tbottom: 50rpx;\r\n\t\tpadding: 30rpx;\r\n\t\tbackground: #fff;\r\n\t\t/* margin-top: auto; */\r\n\t}\r\n\r\n\t// .btn-charge {\r\n\t// \tbackground: linear-gradient(135deg, #1e90ff, #3a8bff);\r\n\t// \tcolor: #fff;\r\n\t// \tfont-size: 30rpx;\r\n\t// \tpadding: 20rpx 0;\r\n\t// \ttext-align: center;\r\n\t// \tborder-radius: 60rpx;\r\n\t// \twidth: 100%;\r\n\t// }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t.recharge-card-box {\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 10rpx;\r\n\r\n\t\t.pay-input-box {\r\n\t\t\tmargin-bottom: 40rpx;\r\n\r\n\t\t\t.input-title {\r\n\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\tcolor: red;\r\n\t\t\t\tpadding: 25rpx 20rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.input-box {\r\n\t\t\t\tpadding: 0rpx 20rpx;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\r\n\t\t\t\t.yuan-text {\r\n\t\t\t\t\tfont-size: 33rpx;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tborder-bottom: 1px solid #f3f4f6;\r\n\t\t\t\tpadding-bottom: 20rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.remark {\r\n\t\tmargin-top: 16rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #808080;\r\n\t}\r\n\r\n\t.input {\r\n\t\tmargin-left: 14rpx;\r\n\t\tfont-size: 33rpx;\r\n\t}\r\n\r\n\t.popup-header {\r\n\t\ttext-align: center;\r\n\t\tfont-size: 30rpx;\r\n\t\tpadding: 24rpx;\r\n\t\tcolor: #000;\r\n\t\tfont-weight: 500;\r\n\t\tborder-bottom: 1rpx solid #eee;\r\n\t}\r\n\r\n\t.fui-icon__close {\r\n\t\tposition: absolute;\r\n\t\ttop: 24rpx;\r\n\t\tright: 54rpx;\r\n\r\n\t}\r\n\r\n\t.recharge-btn {\r\n\t\tmargin: 0rpx 20rpx;\r\n\t\tbackground-color: #3366ff;\r\n\t\tcolor: #fff;\r\n\t\tpadding: 20rpx 0;\r\n\t\tfont-size: 28rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\ttext-align: center;\r\n\t}\r\n</style>","import MiniProgramPage from '/Users/zhizhi/Documents/HBuilderProjects/dnf/pages/user/balance.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","useZPaging","uni","res"],"mappings":";;;;;;;;;;;AA4EC,MAAM,SAAS,MAAW;AAC1B,MAAM,UAAU,MAAW;;;;AAC3B,UAAM,SAASA,cAAG,IAAC,IAAI;AACvBC,+DAAAA,WAAW,MAAM;AACjB,UAAM,UAAUD,cAAG,IAAC,IAAI;AACxB,UAAM,SAASA,cAAG,IAAC,IAAI;AACvB,UAAM,eAAeA,cAAG,IAAC,KAAK;AAG9B,UAAM,WAAWA,cAAG,IAAC,EAAE;AAEvB,UAAM,cAAc,OAAO,QAAQ,aAAa;AAC9C,YAAM,MAAM,MAAME,cAAAA,MAAI,MAAM,KAAK,qBAAqB;AAAA,QACpD,MAAM;AAAA,QACN,WAAW;AAAA,MAChB,CAAI;AACD,UAAI,IAAI,SAAS,GAAG;AAClB,gBAAQ,QAAQ,IAAI,KAAK;AACzB,eAAO,MAAM,SAAS,IAAI,KAAK,IAAI;AAAA,MACxC,OAAU;AACL,eAAO,MAAM,SAAS,KAAK;AAAA,MAC5B;AAAA,IACF;AAID,UAAM,aAAa,MAAM;AAIxBA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,MACT,CAAG;AAAA,IACD;AAED,UAAM,aAAa,YAAY;AAC9B,UAAI,OAAO,SAAS,GAAG;AACtBA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AACD,eAAO;AAAA,MACP;AAWD,YAAM,MAAM,MAAMA,cAAAA,MAAI,MAAM,KAAK,qBAAqB;AAAA,QACrD,QAAQ,OAAO;AAAA,MAClB,CAAG;AACD,UAAI,IAAI,SAAS,GAAG;AAEnBA,sBAAAA,MAAI,eAAe;AAAA,UAClB,OAAO,IAAI,KAAK,OAAO;AAAA,UACvB,WAAW,IAAI,KAAK,OAAO;AAAA,UAC3B,UAAU,IAAI,KAAK,OAAO;AAAA,UAC1B,SAAS,IAAI,KAAK,OAAO;AAAA,UACzB,UAAU,IAAI,KAAK,OAAO;AAAA,UAC1B,SAAS,IAAI,KAAK,OAAO;AAAA,UACzB,SAAS,CAACC,SAAQ;AACjBD,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,YACZ,CAAM;AAED,mBAAO,MAAM;AACb,yBAAa,QAAQ;AAAA,UACrB;AAAA,UACD,MAAM,CAAC,QAAQ;AACdA,0BAAAA,oDAAY,GAAG;AACfA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,YACZ,CAAM;AAAA,UACD;AAAA,QACL,CAAI;AAAA,MAEJ,OAAS;AACNA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO,IAAI,OAAO;AAAA,UAClB,MAAM;AAAA,QACV,CAAI;AAAA,MACD;AAAA,IAGD;AAED,UAAM,WAAW,MAAM;AACtB,mBAAa,QAAQ;AAAA,IAErB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5KF,GAAG,WAAW,eAAe;"}