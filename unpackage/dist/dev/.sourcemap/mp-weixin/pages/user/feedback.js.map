{"version":3,"file":"feedback.js","sources":["pages/user/feedback.vue","pages/user/feedback.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"feedback-page\">\r\n\r\n\t\t<view class=\"section\">\r\n\t\t\t<view class=\"label\">问题分类：</view>\r\n\t\t\t<view class=\"type-list\">\r\n\t\t\t\t<view v-for=\"item in typeList\" :key=\"type\" class=\"type-tag\" :class=\"{ active: selectedType === item }\"\r\n\t\t\t\t\t@tap=\"selectedType = item\">\r\n\t\t\t\t\t{{ item }}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\r\n\t\t<view class=\"section\">\r\n\t\t\t<textarea class=\"textarea\" placeholder=\"请简要描述您的问题和意见\" v-model=\"desc\" />\r\n\t\t</view>\r\n\r\n\r\n\t\t<view class=\"section\">\r\n\t\t\t<view class=\"upload-box\">\r\n\t\t\t\t<!-- <text class=\"plus\">+</text> -->\r\n\t\t\t\t<fui-upload borderColor=\"#eee\" background=\"#Fff\" radius=\"10\" immediate width=\"200\" height=\"200\"\r\n\t\t\t\t\t:url=\"uploadUrl\" :max=\"3\" ref=\"uploadRef\" @success=\"uploadSuccess\"\r\n\t\t\t\t\t@error=\"uploadError\"></fui-upload>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"btn-box\">\r\n\t\t\t<view class=\"submit-btn\" @click=\"submit\">提交</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport fuiUpload from \"@/components/fui-upload.vue\"\r\n\timport {\r\n\t\tbaseUrl\r\n\t} from \"@/util/env\";\r\n\timport {\r\n\t\tref\r\n\t} from 'vue'\r\n\tconst uploadRef = ref(null)\r\n\tconst uploadUrl = baseUrl + '/common/upload'\r\n\tconst uploadStatus = ref(false);\r\n\tconst typeList = ['需求建议', '功能异常', '其他']\r\n\tconst selectedType = ref('需求建议')\r\n\tconst desc = ref('')\r\n\tconst imageList = ref([])\r\n\r\n\r\n\tconst uploadSuccess = (e) => {\r\n\t\tconsole.log(e)\r\n\t\t//上传成功回调，处理服务器返回数据【此处根据实际返回数据进行处理】\r\n\t\tlet res = JSON.parse(e.res.data.replace(/\\ufeff/g, \"\") || \"{}\")\r\n\t\tuploadStatus.value = e.status\r\n\t\tif (res.data.url) {\r\n\t\t\timageList.value = res.data.url;\r\n\t\t\t//处理结果返回给组件 \r\n\t\t\t//data.url为上传成功后返回的图片地址\r\n\t\t\t//e.index为图片索引值\r\n\t\t\t// this.$refs.upload.result(res.data.url, e.index)\r\n\t\t}\r\n\t}\r\n\r\n\tconst uploadError = (e) => {\r\n\t\tuploadStatus.value = e.status\r\n\t\tuni.showModal({\r\n\t\t\tcontent: JSON.stringify(e)\r\n\t\t})\r\n\t}\r\n\r\n\r\n\r\n\tconst submit = async () => {\r\n\t\tif (!desc.value.trim()) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '请填写问题描述',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst res = await uni.$http.post('/dungeon/submitFeedback', {\r\n\t\t\tcontent: desc.value,\r\n\t\t\ttype: selectedType.value,\r\n\t\t\timages: imageList.value\r\n\t\t})\r\n\t\tif (res.code === 1) {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '提交成功',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\n\t\t\tsetTimeout(()=>{\n\t\t\t\tuni.navigateBack()\n\t\t\t},1000)\r\n\t\t}\r\n\r\n\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t.feedback-page {\r\n\t\tpadding: 30rpx;\r\n\t\tbackground-color: #fff;\r\n\r\n\t}\r\n\r\n\t.section {\r\n\t\tmargin-bottom: 30rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.label {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\t/* margin-bottom: 20rpx; */\r\n\t}\r\n\r\n\t.type-list {\r\n\t\tdisplay: flex;\r\n\t\tgap: 20rpx;\r\n\t\tflex-wrap: wrap;\r\n\t}\r\n\r\n\t.type-tag {\r\n\t\tpadding: 10rpx 30rpx;\r\n\t\tborder-radius: 32rpx;\r\n\t\tbackground-color: #f5f5f5;\r\n\t\tcolor: #333;\r\n\t\tfont-size: 26rpx;\r\n\t}\r\n\r\n\t.type-tag.active {\r\n\t\tbackground-color: #e6f0ff;\r\n\t\tcolor: #007aff;\r\n\t}\r\n\r\n\t.textarea {\r\n\t\twidth: 100%;\r\n\t\tmin-height: 200rpx;\r\n\t\tborder-radius: 12rpx;\r\n\t\tbackground-color: #f8f9fb;\r\n\t\tpadding: 20rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t}\r\n\r\n\t.upload-box {\r\n\t\t/* width: 200rpx;\r\n\t\theight: 140rpx; */\r\n\t\t/* background-color: #f8f9fb; */\r\n\t\t/* border-radius: 12rpx; */\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t}\r\n\r\n\t.plus {\r\n\t\tfont-size: 60rpx;\r\n\t\tcolor: #555;\r\n\t}\r\n\r\n\t.btn-box {\r\n\t\tmargin-top: 60rpx;\r\n\t}\r\n\r\n\t.submit-btn {\r\n\t\twidth: 100%;\r\n\t\tbackground-color: #007aff;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 30rpx;\r\n\t\tpadding: 24rpx 0;\r\n\t\ttext-align: center;\r\n\t\tborder-radius: 60rpx;\r\n\t}\r\n</style>","import MiniProgramPage from '/Users/zhizhi/Documents/HBuilderProjects/dnf/pages/user/feedback.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","baseUrl","uni"],"mappings":";;;;;;AAmCC,MAAM,YAAY,MAAW;;;;AAO7B,UAAM,YAAYA,cAAG,IAAC,IAAI;AAC1B,UAAM,YAAYC,SAAAA,UAAU;AAC5B,UAAM,eAAeD,kBAAI,KAAK;AAC9B,UAAM,WAAW,CAAC,QAAQ,QAAQ,IAAI;AACtC,UAAM,eAAeA,cAAG,IAAC,MAAM;AAC/B,UAAM,OAAOA,cAAG,IAAC,EAAE;AACnB,UAAM,YAAYA,cAAG,IAAC,EAAE;AAGxB,UAAM,gBAAgB,CAAC,MAAM;AAC5BE,oBAAAA,MAAA,MAAA,OAAA,iCAAY,CAAC;AAEb,UAAI,MAAM,KAAK,MAAM,EAAE,IAAI,KAAK,QAAQ,WAAW,EAAE,KAAK,IAAI;AAC9D,mBAAa,QAAQ,EAAE;AACvB,UAAI,IAAI,KAAK,KAAK;AACjB,kBAAU,QAAQ,IAAI,KAAK;AAAA,MAK3B;AAAA,IACD;AAED,UAAM,cAAc,CAAC,MAAM;AAC1B,mBAAa,QAAQ,EAAE;AACvBA,oBAAAA,MAAI,UAAU;AAAA,QACb,SAAS,KAAK,UAAU,CAAC;AAAA,MAC5B,CAAG;AAAA,IACD;AAID,UAAM,SAAS,YAAY;AAC1B,UAAI,CAAC,KAAK,MAAM,QAAQ;AACvBA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AACD;AAAA,MACA;AAED,YAAM,MAAM,MAAMA,cAAAA,MAAI,MAAM,KAAK,2BAA2B;AAAA,QAC3D,SAAS,KAAK;AAAA,QACd,MAAM,aAAa;AAAA,QACnB,QAAQ,UAAU;AAAA,MACrB,CAAG;AACD,UAAI,IAAI,SAAS,GAAG;AACnBA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AACD,mBAAW,MAAI;AACdA,wBAAAA,MAAI,aAAc;AAAA,QAClB,GAAC,GAAI;AAAA,MACN;AAAA,IAGD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClGF,GAAG,WAAW,eAAe;"}