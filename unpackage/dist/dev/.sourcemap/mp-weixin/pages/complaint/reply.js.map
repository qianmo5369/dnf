{"version":3,"file":"reply.js","sources":["pages/complaint/reply.vue","pages/complaint/reply.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"appeal-form-page\">\r\n\t\t<!-- 输入投诉内容 -->\r\n\t\t<view class=\"form-section\">\r\n\t\t\t<text class=\"label required\">补充内容</text>\r\n\t\t\t<textarea class=\"textarea\" v-model=\"content\" placeholder=\"请输入补充内容\" />\r\n\t\t</view>\r\n\r\n\t\t<!-- 上传截图 -->\r\n\t\t<view class=\"form-section\">\r\n\t\t\t<text class=\"label\">凭证补充(可选)</text>\r\n\t\t\t<view class=\"upload-box\">\r\n\t\t\t\t<fui-upload borderColor=\"#eee\" background=\"#Fff\" radius=\"10\" immediate width=\"200\" height=\"200\"\r\n\t\t\t\t\t:url=\"uploadUrl\" :max=\"3                                                                                                                                                                                                                                                                          \" ref=\"uploadRef\" @success=\"uploadSuccess\"\r\n\t\t\t\t\t@error=\"uploadError\"></fui-upload>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 提交按钮 -->\r\n\t\t<view class=\"bottom-btn\">\r\n\t\t\t<view class=\"submit-btn\" @tap=\"addComplaintReply\">提交回复</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref,\n\t\tonMounted\r\n\t} from 'vue'\r\n\timport {\r\n\t\tbaseUrl\r\n\t} from \"@/util/env\";\r\n\timport {\r\n\t\tonShow,\r\n\t\tonLoad\r\n\t} from '@dcloudio/uni-app';\n\timport fuiUpload from \"@/components/fui-upload.vue\"\r\n\tconst complaint_id = ref(null)\n\tconst uploadUrl = baseUrl + '/common/upload';\n\tconst selectedIds = ref([])\n\tconst uploadStatus = ref(false);\r\n\tconst content = ref('')\r\n\tconst imageUrl = ref([])\r\n\tconst targets = ref([\r\n\r\n\t])\r\n\tonLoad((params) => {\r\n\t\tif (params.complaint_id) {\r\n\t\t\tcomplaint_id.value = params.complaint_id;\r\n\t\t} else {\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: \"房间不存在\",\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\r\n\t})\n\t\n\t\r\n\r\n\tfunction chooseImage(e) {\r\n\t\tuni.previewImage({\n\t\t\turls: [e], // 需要预览的图片http链接列表\n\t\t\tcurrent: '', // 当前显示图片的http链接，默认是第一个\n\t\t\tsuccess: function(res) {},\n\t\t\tfail: function(res) {},\n\t\t\tcomplete: function(res) {},\n\t\t})\r\n\t}\n\t\n\tconst uploadSuccess = (e) => {\n\t\tconsole.log(e)\n\t\t//上传成功回调，处理服务器返回数据【此处根据实际返回数据进行处理】\n\t\tlet res = JSON.parse(e.res.data.replace(/\\ufeff/g, \"\") || \"{}\")\n\t\tuploadStatus.value = e.status\n\t\tif (res.data.url) {\n\t\t\t// imageUrl.value = res.data.url;\n\t\t\timageUrl.value.push(res.data.url)\n\t\t}\n\t}\n\t\n\tconst uploadError = (e) => {\n\t\tuploadStatus.value = e.status\n\t\tuni.showModal({\n\t\t\tcontent: JSON.stringify(e)\n\t\t})\n\t}\r\n\r\n\tconst addComplaintReply =  async () =>{\n\t\t\r\n\t\tif (!content.value.trim()) {\r\n\t\t\treturn uni.showToast({\r\n\t\t\t\ttitle: '请填写回复内容',\r\n\t\t\t\ticon: 'none'\r\n\t\t\t})\r\n\t\t}\n\t\tconst imagesList = imageUrl.value.join(',')  \n\t\tconst res = await uni.$http.post('/room/addComplaintReply', {\n\t\t    complaint_id: complaint_id.value,\t\n\t\t    content: content.value,\n\t\t    images: imagesList\n\t\t  })\n\t\tif (res.code === 1) {\n\t\t\treturn uni.showToast({\n\t\t\t\ttitle: res.msg,\n\t\t\t\ticon: 'none'\n\t\t\t})\n\t\t}\r\n\t}\r\n</script>\r\n<style scoped>\r\n\t.appeal-form-page {\r\n\t\tpadding: 30rpx;\r\n\t\tbackground-color: #fff;\r\n\t\t/* min-height: 100vh; */\r\n\t}\r\n\r\n\t.form-header {\r\n\t\ttext-align: center;\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\r\n\t.form-title {\r\n\t\tfont-size: 36rpx;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\r\n\t.label {\r\n\t\tfont-size: 30rpx;\r\n\t\tcolor: #333;\r\n\t\tmargin: 20rpx 0rpx;\r\n\t\tdisplay: block;\r\n\t\tfont-weight: 500;\r\n\t}\r\n\r\n\t.label.required::before {\r\n\t\tcontent: '*';\r\n\t\tcolor: red;\r\n\t\tmargin-right: 6rpx;\r\n\t}\r\n\r\n\t.complain-target {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground: #f5f5f5;\r\n\t\tborder-radius: 12rpx;\r\n\t\tpadding: 20rpx;\r\n\t}\r\n\r\n\t.avatar {\r\n\t\twidth: 80rpx;\r\n\t\theight: 80rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tmargin-right: 20rpx;\r\n\t}\r\n\r\n\t.info .name {\r\n\t\tfont-size: 30rpx;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\r\n\t.info .sub {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #999;\r\n\t}\r\n\r\n\t.textarea {\r\n\t\twidth: 100%;\r\n\t\theight: 200rpx;\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 12rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tborder: 2rpx solid #f7f7f7;\r\n\t}\r\n\r\n\t.upload-box {\r\n\t\t/* background: #f7f7f7; */\r\n\t\tborder-radius: 16rpx;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\n\t\tflex-wrap: wrap;\r\n\t\t/* justify-content: center; */\r\n\t}\r\n\r\n\t.upload-placeholder {\r\n\t\tfont-size: 60rpx;\r\n\t\tcolor: #ccc;\r\n\t}\r\n\r\n\t.preview {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tborder-radius: 12rpx;\r\n\t}\r\n\r\n\t.bottom-btn {\r\n\t\tmargin-top: 80rpx;\r\n\t}\r\n\r\n\t.submit-btn {\r\n\t\tbackground: #007aff;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 28rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\tpadding: 25rpx 0;\n\t\ttext-align: center;\r\n\t}\r\n\r\n\t.role-list {\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(2, 1fr);\r\n\t\tgrid-gap: 20rpx;\r\n\t\t/* padding: 30rpx; */\r\n\t\tmargin-top: 30rpx;\r\n\t}\r\n\r\n\t/* 单个角色卡片 */\r\n\t.role-card {\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tbackground: #fff;\r\n\t\tborder-radius: 16rpx;\r\n\t\tpadding: 20rpx;\r\n\t\tbox-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n\t\toverflow: hidden;\n\t\tborder: 2rpx solid transparent;\r\n\t}\r\n\r\n\t/* 三角形背景——尖朝左下，位于右上角 */\r\n\t.card-active::before {\r\n\t\tcontent: \"\";\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tright: 0;\r\n\t\twidth: 90rpx;\r\n\t\t/* 三角边长 */\r\n\t\theight: 60rpx;\r\n\t\tbackground-color: #409eff;\r\n\t\tclip-path: polygon(100% 0%,\r\n\t\t\t\t/* 顶点：右上 */\r\n\t\t\t\t100% 100%,\r\n\t\t\t\t/* 底点：右下 */\r\n\t\t\t\t0% 0%\r\n\t\t\t\t/* 左顶点：左上 */\r\n\t\t\t);\r\n\t}\r\n\r\n\t/* 对勾 */\r\n\t.card-active::after {\r\n\t\tcontent: \"当前\";\r\n\t\tposition: absolute;\r\n\t\ttop: 4rpx;\r\n\t\tright: 4rpx;\r\n\t\tfont-size: 20rpx;\r\n\t\t/* line-height: 50rpx; */\r\n\t\tcolor: #fff;\r\n\t\t/* line-height: 2; */\r\n\t}\r\n\r\n\t/* 文字区域 */\r\n\t.role-info {\r\n\t\tmargin-left: 20rpx;\r\n\t}\r\n\r\n\t.role-value {\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #333;\r\n\t\tfont-weight: bold;\r\n\t}\r\n\r\n\t.role-subtitle {\r\n\t\tfont-size: 24rpx;\r\n\t\tcolor: #888;\r\n\t\tmargin-top: 8rpx;\r\n\t}\n\t\n\t.selected {\n\t  border: 2rpx solid #2e89ff;\n\t  background: #e6f0ff;\n\t}\r\n</style>","import MiniProgramPage from '/Users/zhizhi/Documents/HBuilderProjects/dnf/pages/complaint/reply.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","baseUrl","onLoad","uni"],"mappings":";;;;;;AAsCC,MAAM,YAAY,MAAW;;;;AAC7B,UAAM,eAAeA,cAAG,IAAC,IAAI;AAC7B,UAAM,YAAYC,SAAO,UAAG;AACRD,kBAAAA,IAAI,CAAA,CAAE;AAC1B,UAAM,eAAeA,kBAAI,KAAK;AAC9B,UAAM,UAAUA,cAAG,IAAC,EAAE;AACtB,UAAM,WAAWA,cAAG,IAAC,EAAE;AACPA,sBAAI,CAErB,CAAE;AACDE,kBAAM,OAAC,CAAC,WAAW;AAClB,UAAI,OAAO,cAAc;AACxB,qBAAa,QAAQ,OAAO;AAAA,MAC/B,OAAS;AACNC,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AAAA,MACD;AAAA,IACH,CAAE;AAcD,UAAM,gBAAgB,CAAC,MAAM;AAC5BA,oBAAAA,MAAY,MAAA,OAAA,mCAAA,CAAC;AAEb,UAAI,MAAM,KAAK,MAAM,EAAE,IAAI,KAAK,QAAQ,WAAW,EAAE,KAAK,IAAI;AAC9D,mBAAa,QAAQ,EAAE;AACvB,UAAI,IAAI,KAAK,KAAK;AAEjB,iBAAS,MAAM,KAAK,IAAI,KAAK,GAAG;AAAA,MAChC;AAAA,IACD;AAED,UAAM,cAAc,CAAC,MAAM;AAC1B,mBAAa,QAAQ,EAAE;AACvBA,oBAAAA,MAAI,UAAU;AAAA,QACb,SAAS,KAAK,UAAU,CAAC;AAAA,MAC5B,CAAG;AAAA,IACD;AAED,UAAM,oBAAqB,YAAW;AAErC,UAAI,CAAC,QAAQ,MAAM,QAAQ;AAC1B,eAAOA,cAAAA,MAAI,UAAU;AAAA,UACpB,OAAO;AAAA,UACP,MAAM;AAAA,QACV,CAAI;AAAA,MACD;AACD,YAAM,aAAa,SAAS,MAAM,KAAK,GAAG;AAC1C,YAAM,MAAM,MAAMA,cAAAA,MAAI,MAAM,KAAK,2BAA2B;AAAA,QACxD,cAAc,aAAa;AAAA,QAC3B,SAAS,QAAQ;AAAA,QACjB,QAAQ;AAAA,MACd,CAAK;AACH,UAAI,IAAI,SAAS,GAAG;AACnB,eAAOA,cAAAA,MAAI,UAAU;AAAA,UACpB,OAAO,IAAI;AAAA,UACX,MAAM;AAAA,QACV,CAAI;AAAA,MACD;AAAA,IACD;;;;;;;;;;;;;;;;;;;;;;;;AC5GF,GAAG,WAAW,eAAe;"}