{"version":3,"file":"index.js","sources":["util/request/index.js"],"sourcesContent":["import {\r\n\tbaseUrl\r\n} from \"../env\";\nimport Request from '@/js_sdk/luch-request/luch-request/index.js' // ‰∏ãËΩΩÁöÑÊèí‰ª∂\nimport { useUserStore } from '@/stores/user'\r\n// ÂàõÂª∫ÂÆû‰æã\nconst http = new Request({\n  baseURL: baseUrl, // ‰øÆÊîπ‰∏∫‰Ω†ÁöÑÂú∞ÂùÄ\n  timeout: 10000,\n  custom: {\n    auth: true // Ëá™ÂÆö‰πâÂ≠óÊÆµÁ§∫‰æã\n  }\n})\n\n// ËØ∑Ê±ÇÊã¶Êà™Âô®\nhttp.interceptors.request.use((config) => {\n\tconst userStore = useUserStore()\n\tif (userStore.token) {\n\t    config.header.token = userStore.token\n\t  }\n  // const token = uni.getStorageSync('token')\n  // if (token && config.custom?.auth) {\n  //   config.header.token = token\n  // }\n  uni.showLoading({\n  \ttitle: 'Âä†ËΩΩ‰∏≠...'\n  })\n  return config\n}, (error) => {\n  return Promise.reject(error)\n})\n\n// ÂìçÂ∫îÊã¶Êà™Âô®\nhttp.interceptors.response.use((response) => {\n  // ‰∏öÂä°ÊàêÂäüÁ†Å\n  uni.hideLoading()\n  if (response.data.code === 1 || response.data.code === 200) {\n    return response.data;\n  } else {\n    uni.showToast({\n      title: response.data.msg || 'ËØ∑Ê±ÇÈîôËØØ',\n      icon: 'none'\n    })\n    return Promise.reject(response.data)\n  }\n}, (error) => {\n  console.log(error.statusCode);\n  \n  if (error.statusCode == 401) {\n  \t  uni.showToast({\n  \t    title: 'ËØ∑ÂÖàÁôªÂΩï',\n  \t    icon: 'none'\n  \t  })\n\t  \n\t  const userStore = useUserStore()\n\t      userStore.logout()\n\t  \n  \t uni.reLaunch({ url: '/pages/login/login' })\n  }else{\n\t  uni.showToast({\n\t    title: 'ÁΩëÁªúÂºÇÂ∏∏',\n\t    icon: 'none'\n\t  })\n  }\n \n  \n  // uni.hideLoading()\n  return Promise.reject(error)\n})\n\n\nconst plugin = {\n  install(app) {\n    app.config.globalProperties.$http = http\n    uni.$http = http // ËÆ© setup ‰∏≠‰πüËÉΩ‰ΩøÁî®\n  }\n}\n\n// üëâ ÈáçÁÇπÔºöÂêåÊó∂ÂØºÂá∫Êèí‰ª∂Âíå http ÂÆû‰æã\nexport {\n  http\n}\nexport default plugin\n\n// const test = {}\n// export default test\n\n// export default {\n//   install(app) {\n//     app.config.globalProperties.$http = http\n//   }\n// }"],"names":["Request","baseUrl","useUserStore","uni"],"mappings":";;;;;AAMA,MAAM,OAAO,IAAIA,4CAAAA,QAAQ;AAAA,EACvB,SAASC,SAAO;AAAA;AAAA,EAChB,SAAS;AAAA,EACT,QAAQ;AAAA,IACN,MAAM;AAAA;AAAA,EACP;AACH,CAAC;AAGD,KAAK,aAAa,QAAQ,IAAI,CAAC,WAAW;AACzC,QAAM,YAAYC,YAAAA,aAAc;AAChC,MAAI,UAAU,OAAO;AACjB,WAAO,OAAO,QAAQ,UAAU;AAAA,EACjC;AAKFC,gBAAAA,MAAI,YAAY;AAAA,IACf,OAAO;AAAA,EACV,CAAG;AACD,SAAO;AACT,GAAG,CAAC,UAAU;AACZ,SAAO,QAAQ,OAAO,KAAK;AAC7B,CAAC;AAGD,KAAK,aAAa,SAAS,IAAI,CAAC,aAAa;AAE3CA,gBAAAA,MAAI,YAAa;AACjB,MAAI,SAAS,KAAK,SAAS,KAAK,SAAS,KAAK,SAAS,KAAK;AAC1D,WAAO,SAAS;AAAA,EACpB,OAAS;AACLA,kBAAAA,MAAI,UAAU;AAAA,MACZ,OAAO,SAAS,KAAK,OAAO;AAAA,MAC5B,MAAM;AAAA,IACZ,CAAK;AACD,WAAO,QAAQ,OAAO,SAAS,IAAI;AAAA,EACpC;AACH,GAAG,CAAC,UAAU;AACZA,gBAAY,MAAA,MAAA,OAAA,+BAAA,MAAM,UAAU;AAE5B,MAAI,MAAM,cAAc,KAAK;AAC1BA,kBAAAA,MAAI,UAAU;AAAA,MACZ,OAAO;AAAA,MACP,MAAM;AAAA,IACb,CAAM;AAEH,UAAM,YAAYD,YAAAA,aAAc;AAC5B,cAAU,OAAQ;AAErBC,kBAAAA,MAAI,SAAS,EAAE,KAAK,qBAAoB,CAAE;AAAA,EAC9C,OAAO;AACJA,kBAAAA,MAAI,UAAU;AAAA,MACZ,OAAO;AAAA,MACP,MAAM;AAAA,IACX,CAAI;AAAA,EACD;AAID,SAAO,QAAQ,OAAO,KAAK;AAC7B,CAAC;AAGI,MAAC,SAAS;AAAA,EACb,QAAQ,KAAK;AACX,QAAI,OAAO,iBAAiB,QAAQ;AACpCA,kBAAG,MAAC,QAAQ;AAAA,EACb;AACH;;"}